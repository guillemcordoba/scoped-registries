<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Scoped Custom Element Registries</title>
    <script type="module" src="../index.js"></script>
</head>
<body>

  <my-element></my-element>

  <script type="module">
    // x-foo.js is an existing custom element module that registers a class
    // as 'x-foo' in the global registry.
    import { XFoo } from './XFoo.js';

    // Create a new registry that inherits from the global registry
    const myRegistry = new CustomElementRegistry(window.customElements);

    // Define a trivial subclass of XFoo so that we can register it ourselves
    class MyFoo extends XFoo {}

    // Register it as `my-foo` locally.
    myRegistry.define('my-foo', MyFoo);

    class MyElement extends HTMLElement {
      constructor() {
        super();
        // Use the local registry when creating the ShadowRoot
        this.attachShadow({mode: 'open', customElements: myRegistry});

        // Use the scoped element creation APIs to create elements:
        const myFoo = this.shadowRoot.createElement('my-foo');
        this.shadowRoot.appendChild(myFoo);

        // myFoo is now associated with the scope of `this.shadowRoot`, and registry
        // of `myRegistry`. When it creates new DOM, is uses `myRegistry`:
        myFoo.innerHTML = `<my-bar></my-bar>`;
      }
    }

    customElements.define('my-element', MyElement);
  </script>


</body>
</html>
